{% extends "mid_base.html" %}
{% block header %}
    <script type="text/javascript">
    $(function(){
       $("#down_key").click(function(){
           $("#down_holder").attr("src","{{ url_for("product.down_key") }}");
       });
    });
    </script>
{% endblock %}
{% block mid %}
    <blockquote xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
        <p>未完成订单</p>
        <small>未付款以及未完工的订单</small>
    </blockquote>
    {% if orders %}
    <table class="table">
        <thead>
        <tr>
            <td>生成时间</td>
            <td>订单号</td>
            <td>合计金额</td>
            <td>优惠合计金额</td>
            <td>状态</td>
            <td></td>
        </tr>
        </thead>
        <tbody>
        {% for order in orders %}
            <tr>
                <td>{{ order.create_time }}</td>
                <td><strong>{{ order.serial_number }}</strong></td>
                <td>{{ order.total_fee }} ¥</td>
                <td>{{ order.favor_fee }} ¥</td>
                <td>{{ order.status | order_status }}</td>
                <td><a href="{{ url_for("product.order_Detail",order_id=order.id) }}" class="btn">查看订单详情</a></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        没有未完成订单
    {% endif %}
    {% if profile.down_key %}
        <div class="well">您的私钥已经下载过了，如果丢失，请联系管理员</div>
    {% else %}
        <div class="well"><a id="down_key" href="javascript:void(0);">下载登陆私钥</a>&nbsp;注意：为了保证您的数据安全，服务器将不保存您的私钥，私钥下载后请妥善保存
        <iframe id="down_holder" width="0" height="0" src="" style="display: none;"></iframe>
        </div>
    {% endif %}
    <blockquote>
        <p>我的主机</p>
        <small>已经完工的可用主机</small>
    </blockquote>
    <table class="table">
        <thead>
        <tr>
            <td>主机名称</td>
            <td>操作系统</td>
            <td>CPU</td>
            <td>内存</td>
            <td>存储</td>
            <td>状态</td>
            <td>操作</td>
        </tr>
        </thead>
        <tbody>
        {% for product in products %}
        <tr>
            <td>{{ product.instance_name }}</td>
            <td>
                {% if product.image_id %}
                    {{ product.image_id }}
                {% else %}
                    未安装
                {% endif %}
            </td>
            <td>{{ product.product.cpu }}核</td>
            <td>{{ product.product.memory|mems }}</td>
            <td>{{ product.product.storage }}G</td>
            <td>准备创建</td>
            <td>
                {% if product.image_id %}
                    <div class="btn-group">
                        <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                            操作主机
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#">重启</a></li>
                            <li><a href="#">关机</a></li>
                            <li><a href="{{ url_for("product.server_vnc",user_product_id=product.id) }}">打开VNC</a></li>
                            <li><a href="#">申请删除</a></li>
                        </ul>
                    </div>
                {% else %}
                    <a href="{{ url_for("product.show_create_server",user_product_id=product.id) }}"  class="btn btn-primary" type="button">创建实例</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        <tr>
            <td>经济B型</td>
            <td>CentOS6.2</td>
            <td>1核</td>
            <td>512M</td>
            <td>10G</td>
            <td>正常运行</td>
            <td>

            </td>
        </tr>
        </tbody>
    </table>

{% endblock %}